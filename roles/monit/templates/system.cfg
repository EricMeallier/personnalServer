check system ovh.info
  if memory usage > 90% for 5 cycles then alert
  if swap usage > 25% for 3 cycles then alert
  if loadavg (1min) > 3 for 10 times within 10 cycles then alert
  if loadavg (5min) > 5 for 10 times within 10 cycles then alert
check network eth0 with interface eth0 
    if upload > 5 mB/s for 5 times within 10 cycles then alert
    if download > 5 mB/s for 5 times within 10 cycles then alert
    if total download > 3 GB in last 2 hours then alert
    if total download > 2 GB in last day then alert
check filesystem fs.ovh.info with path /dev/sda1
  if space usage > 90% then alert
check process redmine MATCHING "Passenger AppPreloader\: \/opt\/redmine"
  if does not exist then alert
check process gogs MATCHING "\/opt\/gogs\/gogs web"
  if does not exist then alert
check process etherpad MATCHING "node src\/node\/server.js"
  if does not exist then alert
check process ethercalc MATCHING "bin\/ethercalc"
  if does not exist then alert
check process jitsi MATCHING "org\.jitsi\.videobridge\.Main"
  if does not exist then alert
check process proxyNginx MATCHING "nginx\: master process"
  if does not exist then alert
check process monit MATCHING "\/usr\/bin\/monit"
  if does not exist then alert
check process postgresql MATCHING "postgres\: 11\/main"
  if does not exist then alert
check process php8.0(nextcloud) MATCHING "php-fpm\: master process \(\/etc\/php\/8.0"
  if does not exist then alert
check process php7.3(pico) MATCHING "php-fpm\: master process \(\/etc\/php\/7.3"
  if does not exist then alert


SET MAILSERVER {{ mail.smtp.address }} PORT {{ mail.smtp.port }}
  USERNAME {{ mail.smtp.username }}
  PASSWORD {{ mail.smtp.password }}
  with timeout 30 seconds

SET mail-format {
              from:     {{ mail.smtp.from }}
              subject:  $SERVICE $EVENT - $ACTION
              message:

              This event occurred on $HOST at $DATE: $SERVICE $DESCRIPTION

              Your faithful monit,
              https://monit.meallier.fr
}
SET ALERT {{ mail.smtp.alertingTo }} on {nonexist, timeout, status, resource}
